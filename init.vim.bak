"         _
"  __   _(_)_ __ ___  _ __ ___
"  \ \ / / | '_ ` _ \| '__/ __|
"   \ V /| | | | | | | | | (__
"    \_/ |_|_| |_| |_|_|  \___|
"

" use pathogen as pluginmanager:
"  execute pathogen#infect()

" Some basics:
  let mapleader=","
  set encoding=utf-8
  set number relativenumber
  set cursorline

  syntax on

  filetype plugin indent on
  set expandtab
  set shiftwidth=2
  set softtabstop=2

" Set textwidth to 80, this implies word wrap.
  "set textwidth=80


" No need to be compatible with vi and lose features.
  set nocompatible


" Enable autocompletion:
  set wildmode=longest,list,full


" Disable automatic commenting on newline:
  autocmd FileType * setlocal formatoptions-=c formatoptions-=r formatoptions-=o


" Spell-check set to <leader>o, 'o' for 'orthography':
  map <leader>o :setlocal spell! spelllang=en_us<CR>
  map <leader>l :setlocal spell! spelllang=de<CR>


" Splits open at the bottom and right, which is non-retarded, unlike vim defaults.
  set splitbelow splitright


" Shortcutting split navigation, saving a keypress:
  map <C-h> <C-w>h
  map <C-j> <C-w>j
  map <C-k> <C-w>k
  map <C-l> <C-w>l


"----- Keybinding -----
  " F5 to run the Makefile
  nnoremap <F5> :make!<cr>

  " F9 to run current python file
  autocmd FileType python map <buffer> <F9> :w<CR>:exec '!python3' shellescape(@%, 1)<CR>
  autocmd FileType python imap <buffer> <F9> <esc>:w<CR>:exec '!python3' shellescape(@%, 1)<CR>

  autocmd FileType tex map <buffer> <F9> :w<CR>:exec '!pdflatex' shellescape(@%, 1)<CR>
  autocmd FileType tex imap <buffer> <F9> <esc>:w<CR>:exec '!pdflatex' shellescape(@%, 1)<CR>

" ultisnips configuration
  let g:UltiSnipsExpandTrigger="<tab>"
  let g:UltiSnipsJumpForwardTrigger="<c-l>"
  let g:UltiSnipsJumpBackwardTrigger="<c-h>"

  " If you want :UltiSnipsEdit to split your window.
  let g:UltiSnipsEditSplit="vertical"


" nerdtree config
"  map <C-n> :NERDTreeToggle<CR>
"  " close vim if the only window left is nerdtree.
"  autocmd bufenter * if (winnr("$") == 1 && exists("b:NERDTree") && b:NERDTree.isTabTree()) | q | endif
"
"  " open nerdtree automatically when vim starts up on opening a directory.
"  autocmd StdinReadPre * let s:std_in=1
"  autocmd VimEnter * if argc() == 1 && isdirectory(argv()[0]) && !exists("s:std_in") | exe 'NERDTree' argv()[0] | wincmd p | ene | exe 'cd '.argv()[0] | endif


" temporarily disable exclusive selection whenever vim-multiple-cursors is active
"  augroup MultipleCursorsSelectionFix
"      autocmd User MultipleCursorsPre  if &selection ==# 'exclusive' | let g:multi_cursor_save_selection = &selection | set selection=inclusive | endif
"      autocmd User MultipleCursorsPost if exists('g:multi_cursor_save_selection') | let &selection = g:multi_cursor_save_selection | unlet g:multi_cursor_save_selection | endif
"  augroup END


" Delete trailing white spaces
  func! DeleteTrailingWS()
    exe "normal mz"
    %s/\s\+$//ge
    exe "normal `z"
  endfunc
  noremap <leader>w :call DeleteTrailingWS()<CR>
  autocmd BufWrite *.cpp :call DeleteTrailingWS()

  autocmd BufWritePre * %s/\s\+$//e


" Plugin manager
call plug#begin()
  Plug 'roxma/nvim-completion-manager'
  Plug 'SirVer/ultisnips'
  Plug 'honza/vim-snippets'
  Plug 'scrooloose/nerdtree'
call plug#end()
